# Security Rules for Chat App
#
# Users can only access their own data under users/{userId}/*

database: default
rules_version: '1'
service: syntrix

match:
  /databases/{database}/documents:
    match:
      # User-specific data: users can only access their own data
      # Path pattern: users/{userId}/orch-chats/{chatId}/...
      /users/{userId}/{document=**}:
        allow:
          # Users can read/write their own data
          read, write: "request.auth != null && request.auth.sub == userId"

      # Admin can access all data
      /{document=**}:
        allow:
          read, write: "request.auth != null && request.auth.roles.hasAny(['admin'])"
