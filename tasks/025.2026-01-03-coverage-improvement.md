# Coverage Improvement Report

## Status
- **Date**: 2026-01-03
- **Status**: Completed

## Summary
Addressed critical coverage gaps identified in `make coverage` report, specifically targeting `internal/puller` package.

## Changes

### 1. `internal/puller/internal/cursor`
- **Issue**: Coverage was 78.6% (Critical < 85%).
- **Fix**: Added comprehensive tests for `ProgressMarker` including edge cases (nil receiver, nil map, invalid input).
- **Result**: Coverage improved to 92.9%.

### 2. `internal/puller/internal/core`
- **Issue**: `Subscribe` method had uncovered error handling paths.
- **Fix**: Added tests for `Subscribe` with valid and invalid `after` tokens.
- **Result**: Coverage improved to 94.2%.

### 3. `internal/puller/internal/normalizer`
- **Issue**: Missing tests for `convertBsonValue`.
- **Fix**: Added `TestConvertBsonValue` covering various BSON types including `primitive.DateTime` (handling timezone correctly).
- **Result**: Coverage is 96.3%.

### 4. `internal/puller/internal/client`
- **Issue**: Missing tests for `convertEvent`.
- **Fix**: Added `TestConvertEvent` covering full document, update description, and error cases.
- **Result**: Coverage is 91.9%.

## Verification
Ran `make coverage` and confirmed no critical issues remain in the modified packages.
